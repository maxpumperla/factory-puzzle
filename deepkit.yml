config:
  # Fixed settings (don't touch)
  env_name: factory
  actions: 5
  low: -1
  high: 10

  # Factory settings
  layout: small  # either "big" or "small"
  num_tables: 3
  num_cores: 3
  num_phases: 3
  random_init: True  # if random initialization is False, the factory will reset to the same state after each episode.
  # seed: 1337  # Optional random seed to have full control over initial factory state.

  # Logging & Tracking
  local_mode: False  # if "True", will start ray as single process for easier debugging in your IDE
  deepkit_logging: True  #
  deepkit_account: deepkit # or localhost
  experiment_list: my_experiment

  # RL-specific configuration
  env: RoundRobinFactoryEnv  # "FactoryEnv", "RoundRobinFactoryEnv", "MultiAgentFactoryEnv"
  max_num_steps: 5000 # NOTE: need to set this high enough for the big factory
  masking: True  # whether to use action masking
  use_dqn: False  # If True, use DQN, else PPO
  use_offline_data: False  # Use previously generated offline data (don't use for now, experimental)
  num_samples: 4  # Ray rllib's "num_samples" extracted for convenience
  multi_policy: False # Using multiple policies or not. This only works for "MultiAgentEnv"


  # Observation selection
  ## Agent & core obs
  obs_agent_id: False
  obs_agent_coordinates: False
  obs_agent_has_core: False
  obs_agent_core_target_coordinates: False

  ## Neighbour obs
  obs_agent_has_neighbour: False
  obs_agent_free_neighbour: True

  ## One-hot representation obs
  obs_agent_id_one_hot: True
  obs_agent_core_target_one_hot: True
  obs_all_tables_one_hot: True
  obs_all_cores_one_hot: False

  # Reward selection
  rew_collisions: True
  rew_found_target: True
  rew_avoid_cores: True
  rew_punish_slow_tables: False


# Note: only touch anything below this line if you're certain you know what you're doing :P
image: python:3.7

build:
  - ADD requirements.txt
  - pip install -r requirements.txt
  - ADD factory/
  - ADD setup.py
  - python setup.py install

#env:
#  - PYTHONPATH=/job

output:
  - DQN
  - PPO

ignore:
  - DQN
  - PPO
  - models
  - tests
  - assets
  - venv
  - .pytest_cache

title: Factory solver

list: my_experiment

labels:
  - rllib
  - tensorflow

command: python examples/save_trainer.py
